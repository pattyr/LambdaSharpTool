Version: "2018-07-04"

Name: LambdaSharpS3PackageLoader

Parameters:

  - Name: S3BucketPermissions
    Description: LambdaSharpS3PackageLoader requires read-write access to all buckets
    Values: 
      - "arn:aws:s3:::{{Deployment}}-*"
      - "arn:aws:s3:::{{Deployment}}-*/*"
    Resource:
      Type: AWS::S3::Bucket
      Allow: ReadWrite

  - Name: S3PackageLoaderCustomResourceTopic
    Description: Custom resource topic for synchronizaing packages with S3 buckets
    Export: /{{Deployment}}/LambdaSharp/S3PackageLoaderCustomResourceTopic
    Resource:
      Type: AWS::SNS::Topic
      Allow: Subscribe

Functions:

  - Name: ResourceHandler
    Memory: 128
    Timeout: 300
    Sources:
      - Topic: S3PackageLoaderCustomResourceTopic
